<?xml version="1.0" encoding="UTF-8"?>
<project name="h2zero-sample">
	<path id="classpath-h2zero">
		<fileset dir="lib/runtime">
			<include name="*.jar"/>
		</fileset>
	</path>

	<target name="download-dependencies" description="">
		<copy file="../h2zero/dist/h2zero.jar" todir="lib/runtime" overwrite="true" />
	</target>

	<target name="h2zero" description="h2zero generate">
		<taskdef name="h2zero" classpathref="classpath-h2zero" classname="synapticloop.h2zero.ant.H2ZeroTask" />
		<h2zero in="src/main/java/sample.h2zero" outDir="." verbose="false" />
	</target>

	<target name="h2zero-quick" description="test the h2zero quick generation">
		<taskdef resource="h2zero.properties" classpath="classpath-h2zero" />
		<h2zero.quick tables="user_type, user, pet, user_pet" foreign="user.user_type, user_pet.user, user_pet.pet" />
	</target>

	<target name="gen" description="templar-gen the pages">
		<java jar="templar-gen.jar" fork="true" failonerror="true" maxmemory="128m">
			<arg value="src" />
			<arg value="." />
		</java>
	</target>

	<target name="convert" description="templar-convert the sample.h2zero file">
		<java jar="templar-convert.jar" fork="true" failonerror="true" maxmemory="128m" output="src/imports/h2zero/sample.templar">
			<arg value="src/main/java/sample.h2zero" />
			<arg value="html" />
		</java>
		
		<copy todir="src/main/java" overwrite="true">
			<fileset dir="src/main/java">
				<include name="**/*.java"/>
			</fileset>
			<mapper type="glob" from="*.java" to="*.java.html" />
		</copy>

		<replaceregexp match="^" replace="&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;chrome=1&quot;&gt;&lt;title&gt;h2zero by synapticloop&lt;/title&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/h2zero/stylesheets/styles.css&quot;&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/h2zero/stylesheets/pygment_trac.css&quot;&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/h2zero/stylesheets/prettify.css&quot; type=&quot;text/css&quot; /&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, user-scalable=no&quot;&gt;&lt;!--[if lt IE 9]&gt;&lt;script src=&quot;//html5shiv.googlecode.com/svn/trunk/html5.js&quot;&gt;&lt;/script&gt;&lt;![endif]--&gt;&lt;script src=&quot;/h2zero/javascripts/prettify.js&quot; type=&quot;text/javascript&quot; &gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;wrapper&quot;&gt;&lt;pre class=&quot;prettyprint lang-java linenums&quot;&gt;&lt;code&gt;" flags="s">
			<fileset dir="src/main/java" includes="**/*.html" />
		</replaceregexp>

		<replaceregexp match="$" replace="&lt;/pre&lt;/code&gt;&lt;/div&gt;&lt;script src=&quot;/h2zero/javascripts/scale.fix.js&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;" flags="s">
			<fileset dir="src/main/java" includes="**/*.html" />
		</replaceregexp>
	</target>
	
	<target name="dist" depends="h2zero,convert,gen" description="build all of the documentation" />
</project>
